<!DOCTYPE html>
<html lang="ko" xmlns:th="https://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>변호사회원가입</title>
  <link rel="stylesheet" th:href="@{/css/lJoin.css}">
  <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>
  <div class="include" th:replace="~{include/header :: header}"></div>

  <!-- ✅ 로그인 상태별 마이페이지 진입 버튼 (추가) -->
  <div class="wrap" style="display:flex; justify-content:flex-end; gap:8px; margin:12px 0;">
    <a th:if="${session.loginUser != null}"
       class="primary-btn"
       th:href="@{/member/mypage}">
      마이페이지
    </a>
    <a th:if="${session.loginUser == null}"
       class="small-btn"
       th:href="@{/member/login(need='mypage')}">
      로그인하고 마이페이지
    </a>
  </div>
  <!-- ✅ 여기까지 추가 -->

  <main class="page-lJoin">
    <section class="center-card">
      <div class="head"><h1 class="title">회원가입</h1></div>

      <form id="lawyerJoinForm" class="form"
            th:action="@{/member/join/lawyer}" method="post"
            enctype="multipart/form-data" novalidate>

        <th:block th:if="${_csrf != null}">
          <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
        </th:block>

        <!-- 아이디 + 중복확인 -->
        <div class="field">
          <div class="inline">
            <input id="lawyerId" name="lawyerId" class="input" type="text"
                   placeholder="아이디" autocomplete="username" required>
            <button class="pill" type="button" id="dupBtn">중복확인</button>
          </div>
          <small id="dupMsg" class="help"></small>
        </div>

        <!-- 비밀번호 / 확인 -->
        <div class="field"><input id="lawyerPass" name="lawyerPass" class="input" type="password" placeholder="비밀번호" required></div>
        <div class="field">
          <input id="passConfirm" class="input" type="password" placeholder="비밀번호 확인" required>
          <small id="pwMsg" class="help"></small>
        </div>

        <!-- 닉네임/이메일/주소/전화/생년월일 -->
        <div class="field"><input id="lawyerName" name="lawyerName" class="input" type="text" placeholder="닉네임" required></div>
        <div class="field"><input id="lawyerEmail" name="lawyerEmail" class="input" type="email" placeholder="이메일" required></div>
        <div class="field"><input id="lawyerAddress" name="lawyerAddress" class="input" type="text" placeholder="사무실 주소"></div>
        <div class="field"><input id="lawyerPhone" name="lawyerPhone" class="input" type="tel" placeholder="전화번호(예: 010-1234-5678)" inputmode="numeric" required></div>
        <div class="field"><input id="lawyerIdnum" name="lawyerIdnum" class="input" type="text" placeholder="생년월일(예: 990101)" inputmode="numeric" required></div>

        <!-- 한줄소개 + 상담 가능 요일/시간 -->
        <div class="field">
          <div class="inline align-start">
            <label class="photo">사진</label>
            <div class="flex-1">
              <input id="lawyerIntro" name="lawyerIntro" class="input" type="text" placeholder="한줄소개">
              <label>상담 가능 요일 및 시간대</label>
              <div class="days">
                <input type="checkbox" id="mon" value="월"><label for="mon">월</label>
                <input type="checkbox" id="tue" value="화"><label for="tue">화</label>
                <input type="checkbox" id="wed" value="수"><label for="wed">수</label>
                <input type="checkbox" id="thu" value="목"><label for="thu">목</label>
                <input type="checkbox" id="fri" value="금"><label for="fri">금</label>
                <input type="checkbox" id="sat" value="토"><label for="sat">토</label>
                <input type="checkbox" id="sun" value="일"><label for="sun">일</label>
              </div>
              <div class="inline">
                <input id="timeStart" class="input" type="time" style="flex:1">
                <span style="margin:0 6px">~</span>
                <input id="timeEnd" class="input" type="time" style="flex:1">
              </div>
              <button type="button" class="small-btn" id="addTime">추가</button>
              <div id="selectedList" class="selected-list"></div>
            </div>
          </div>
        </div>

        <!-- 업로드 + 동의 -->
        <div class="field">
          <div class="agree-area">
            <div class="left">
              <input id="idImage" name="idImage" type="file" accept="image/*" style="display:none" />
              <button type="button" class="small-btn" id="idPickBtn">신분증 업로드</button>

              <input id="certImage" name="certImage" type="file" accept="image/*" style="display:none" />
              <button type="button" class="small-btn" id="certPickBtn">등록증 업로드</button>
            </div>
            <div class="right">
              <input type="hidden" id="lawyerAgree" name="lawyerAgree" value="N">
              <button class="small-btn" type="button" id="privacyBtn">개인 정보 수신 동의</button>
            </div>
          </div>

          <div class="inline align-start" style="margin-top:8px">
            <div class="flex-1"><div id="idImagePreview" class="thumb"></div></div>
            <div class="flex-1"><div id="certImagePreview" class="thumb"></div></div>
          </div>
          <small id="fileMsg" class="help">신분증과 등록증 이미지를 모두 첨부해야 합니다.</small>
        </div>

        <input type="hidden" id="availabilityJson" name="availabilityJson" value="[]">

        <div class="divider"></div>
        <button class="primary-btn" type="submit" id="submitBtn">회원가입</button>
      </form>
    </section>
  </main>

  <div class="include" th:replace="~{include/footer :: footer}"></div>

  <script th:src="@{/js/js.js}"></script>
  <script th:src="@{/js/lJoin.js}"></script>
  <script th:if="${alert}" th:inline="javascript">
        /*<![CDATA[*/
        alert('[[${alert}]]'); // 전달된 alert 메세지 출력
        /*]]>*/
    </script>
</body>
</html>
