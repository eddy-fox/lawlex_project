<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Î¨∏ÏùòÍ∏ÄÎ™©Î°ù</title>
    <link th:href="@{/css/style.css}" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/qnaList.css}">
</head>

<body>
    <div class="include" th:replace="~{include/header :: header}"></div>
    <main class="page-qnaList">
        <div class="container">
            <section>
                <div class="searchbar" th:action="@{/qnaList}">
                    <form class="search" th:action="@{/question/qnaList}" method="get">
                        <svg viewBox="0 0 24 24" aria-hidden="true">
                            <circle cx="11" cy="11" r="7" stroke-width="2" />
                            <path d="M16 16l5 5" stroke-width="2" />
                        </svg>
                        <input type="text" name="search" placeholder="Í≤ÄÏÉâ" th:value="${search}">
                        <button type="submit" class="btn-search">Í≤ÄÏÉâ</button>
                    </form>
                    <a class="btn"
                        th:if="${session.loginUser != null}"
                        th:href="${mine} ? @{/question/qnaList(page=1, mine=false)} : @{/question/qnaList(page=1, mine=true)}"
                        th:text="${mine} ? 'Ï†ÑÏ≤¥ Î¨∏Ïùò Î≥¥Í∏∞' : 'ÎÇ¥Í∞Ä ÏûëÏÑ±Ìïú Î¨∏Ïùò Î≥¥Í∏∞'">
                    </a>
                </div>

                <table>
                    <thead>
                        <tr>
                            <th class="num" scope="col">Î≤àÌò∏</th>
                            <th class="title" scope="col">Î¨∏Ïùò Ï†úÎ™©</th>
                            <th class="answer" scope="col">ÎãµÎ≥ÄÏÉÅÌÉú</th>
                            <th class="date" scope="col">ÏûëÏÑ±ÎÇ†Ïßú</th>
                        </tr>
                    </thead>

                    <tbody th:if="${#lists.isEmpty(qnaPaging.content)}">
                        <tr>
                            <td class="not" colspan="4">
                                Îì±Î°ùÎêú Î¨∏ÏùòÍ∞Ä ÏóÜÏäµÎãàÎã§
                            </td>
                        </tr>
                    </tbody>

                    <tbody th:unless="${#lists.isEmpty(qnaPaging.content)}">

                        <tr th:each="qList : ${qnaPaging.content}">
                            <td class="num" th:text="${qList.qIdx}">1</td>

                            <td class="title" th:with="isSecret = ${qList.qSecret == 1 or (qList.qSecret == '1')},
                                                        canSee = ${!isSecret 
                                                                             or (adminIdx != null)
                                                                             or (myIdxM != null and myIdxM == qList.memberIdx)
                                                                             or (myIdxL != null and qList.lawyerIdx != null and myIdxL == qList.lawyerIdx)}">

                                <a th:if="${canSee}"
                                   th:href="@{/question/qnaInfo(qIdx=${qList.qIdx})}"
                                   th:text="${isSecret ? (adminIdx != null ? 'üîí ' + qList.qTitle : 'üîí [Î≥∏Ïù∏Í∏Ä] '+qList.qTitle) : qList.qTitle}"></a>
                                                                
                                   <span th:if="${!canSee}" th:text="'üîí ÎπÑÎ∞ÄÍ∏Ä ÏûÖÎãàÎã§'"></span>
                                </td>
                                <!--  <a th:if="${isSecret}" th:href="@{/question/qnaInfo(qIdx=${qList.qIdx})}" th:text="${'üîí'+qList.qTitle}"></a>
                                 <a th:if="${isSecret}" th:href="@{/question/qnaInfo(qIdx=${qList.qIdx})}">üîí ÎπÑÎ∞ÄÍ∏Ä ÏûÖÎãàÎã§</a>
                                 <a th:if="${!isSecret}" th:href="@{/question/qnaInfo(qIdx=${qList.qIdx})}" th:text="${qList.qTitle}"></a> -->

                            <td class="answer" th:text="${qList.qAnswer == 1 ? '‚úì' : '-'}">-</td>

                            <td class="date"><time th:text="${qList.qRegDate}">2025-12-24</time></td>
                        </tr>
                    
                    </tbody>
                </table>

                <nav class="pager" 
                     th:if="${qnaPaging.totalPages > 0}"
                     th:with="current=${qnaPaging.number + 1},
                              total=${qnaPaging.totalPages},
                              block=${T(java.lang.Math).floorDiv(current - 1, 10)},
                              start=${block*10 + 1},
                              end=${T(java.lang.Math).min(total, start + 9)}">

                    <a class="prev" th:href="@{/question/qnaList(page=${current - 1}, mine=${mine})}">&lt;</a>
                    <a class="page"
                        th:each="n : ${#numbers.sequence(start, end)}"
                        th:text="${n}"
                        th:href="@{/question/qnaList(page=${n}, mine=${mine})}"
                        th:classappend="${n == current} ? ' current'">
                    </a>
                    <a class="next" th:href="@{/question/qnaList(page=${current + 1}, mine=${mine})}">&gt;</a>
                </nav>



                <div class="row-actions">
                    <a class="write" th:href="@{/question/qnaWrite}">Î¨∏Ïùò Í∏ÄÏì∞Í∏∞</a>
                </div>
            </section>
        </div>
    </main>
    <div class="include" th:replace="~{include/footer :: footer}"></div>
    <script th:src="@{/js/js.js}"></script>
    <script th:src="@{/js/qnaList.js}"></script>
    <script th:if="${alert}" th:inline="javascript">
        /*<![CDATA[*/
        alert('[[${alert}]]'); // Ï†ÑÎã¨Îêú alert Î©îÏÑ∏ÏßÄ Ï∂úÎ†•
        /*]]>*/
    </script>
</body>

</html>