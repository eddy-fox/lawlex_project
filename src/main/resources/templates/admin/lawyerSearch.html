<!doctype html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>변호사 검색</title>
    <link th:href="@{/css/style.css}" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/all/memberManagement.css}">
</head>
<body>
    
    <!-- 변호사 리스트 -->
    <section id="sec-user" class="card">
      <div class="scroll">
        <table>
          <thead>
            <tr>
                <th>회원번호</th>
                <th>ID</th>
                <th>이름</th>
                <th>생년월일</th>
                <th>이메일</th>
                <th>전화번호</th>
                <th>관심분야</th>
                <th>자격번호</th>
                <th>선택</th>
            </tr>
          </thead>
          <tbody id="tbody-user">
            <tr th:each="lawyer : ${lawyerList}" th:if="${lawyerList != null and !lawyerList.isEmpty()}">
                <td><span th:text="${lawyer.lawyerIdx}"></span></td>
                <td><span th:text="${lawyer.lawyerId}"></span></td>
                <td><span th:text="${lawyer.lawyerName}"></span></td>
                <td><span th:text="${lawyer.lawyerIdnum}"></span></td>
                <td><span th:text="${lawyer.lawyerEmail}"></span></td>
                <td><span th:text="${lawyer.lawyerPhone}"></span></td>
                <td><span th:text="${lawyer.interestName}"></span></td>
                <td><span th:text="${lawyer.lawyerAuth}"></span></td>
                <td>
                  <button type="button" class="btn"
                    th:attr="data-idx=${lawyer.lawyerIdx}, data-name=${lawyer.lawyerName}"
                    onclick="selectLawyer(this)">선택
                  </button>
                </td>
            </tr>
            <tr th:if="${lawyerList == null or lawyerList.isEmpty()}">
              <td colspan="9" style="text-align: center;">일치하는 변호사가 없습니다.</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

</body>

<script>
    function selectLawyer(button) {
      // 버튼에서 변호사 정보 추출
      const lawyerIdx = button.getAttribute("data-idx");
      const lawyerName = button.getAttribute("data-name");

      // 부모창 input 요소 찾기
      const openerDoc = window.opener.document;

      // 이름 입력창 업데이트
      const nameInput = openerDoc.getElementById("lawyerName");
      if (nameInput) nameInput.value = lawyerName;

      // 변호사 idx용 hidden input이 있으면 채우고, 없으면 새로 만듦
      let idxInput = openerDoc.getElementById("lawyerIdx");
      if (!idxInput) {
        idxInput = openerDoc.createElement("input");
        idxInput.type = "hidden";
        idxInput.id = "lawyerIdx";
        idxInput.name = "lawyerIdx";
        nameInput.parentElement.appendChild(idxInput);
      }
      idxInput.value = lawyerIdx;

      // 창 닫기
      window.close();
    }
</script>
</html>