<!doctype html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>광고 수정</title>
    <link th:href="@{/css/style.css}" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/all/adInfo.css}">
</head>
<body>
    <!-- 헤더 -->
    <div class="include" th:replace="~{include/header :: header}"></div>

    <!-- 메인 -->
    <main class="page-adinfo">

      <!-- 사이드 바 -->
      <div class="sideMenu" th:replace="~{include/aSide :: aSide}"></div>

      <div class="container">

        <!-- 광고 수정 -->
        <form class="ad-card" th:action="@{/admin/adModify}" method="post" 
            th:object="${modifyAd}" enctype="multipart/form-data">
          <input type="hidden" th:field="*{adIdx}">
          <input type="hidden" th:field="*{lawyerIdx}">

          <div class="form-grid">
            <div class="small">광고 이름:</div>
            <input class="input full" type="text" th:field="*{adName}" id="adName" />
            
            <div class="small">신청자:</div>
            <div th:text="${modifyAd.lawyerName}"></div>

            <div class="small">게시일:</div>
            <input class="input full" type="date" th:field="*{adStartDate}" id="adStartDate" />

            <div class="small">게시기간:</div>
            <select class="input full" th:field="*{adDuration}" id="adDuration">
                <option th:value="7" th:text="'7일'"></option>
                <option th:value="14" th:text="'14일'"></option>
                <option th:value="21" th:text="'21일'"></option>
                <option th:value="28" th:text="'28일'"></option>
            </select>
            
            <div class="small">조회수:</div>
            <div th:text="${modifyAd.adViews} + ' 회'"></div>

            <div class="small">이미지</div>
            <div class="form-thumb" id="thumbBox">
                <img id="previewImg" th:if="${modifyAd.adImgPath != null}" th:src="${modifyAd.adImgPath}" th:alt="${modifyAd.adName}">
                <img id="previewImgDefault" th:unless="${modifyAd.adImgPath != null}" th:src="@{/img/test.png}" alt="기본 이미지">
            </div>

            <div class="small" style="margin-top:6px">이미지 링크/업로드</div>
            <div class="fileline">
                <input class="input full" type="url" th:field="*{adImgPath}" id="imgUrl"
                    th:value="${modifyAd.adImgPath}" />
                <input id="adImageFile" type="file" accept="image/*" style="display:none">
                <label class="btn" for="adImageFile">찾아보기</label>
            </div>

            <div class="small">링크</div>
            <div class="fileline">
                <input class="input full" id="linkInput" th:value="${modifyAd.adLink}" />
            </div>
          </div>

            <div class="actions-row">
                <button type="submit" id="submitBtn" class="btn">수정</button>
            </div>
      
        </form>

    <!-- 푸터 -->

</body>

<script>
const imgInput = document.getElementById('adImageFile');
const imgUrlInput = document.getElementById('imgUrl');
const previewImg = document.getElementById('previewImg');
const previewImgDefault = document.getElementById('previewImgDefault');
const thumbBox = document.getElementById('thumbBox');

imgInput.addEventListener('change', function(event) {
    const file = event.target.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = function(e) {
        // 이미지 미리보기
        if (previewImg) previewImg.src = e.target.result;
        if (previewImgDefault) previewImgDefault.style.display = 'none';
        
        // input 값에 반영 (서버 전송용)
        imgUrlInput.value = e.target.result;
    }
    reader.readAsDataURL(file);
});
</script>
</html>
