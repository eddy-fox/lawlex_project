<!-- 로그인 했을 때만 아이콘 보이게 -->
<div class="page-chatIcon"
     th:fragment="page-chatIcon"
     th:with="user=${session.loginUser}, role=${user != null ? user.role : null}"
     th:if="${user != null and role != null and (role == 'MEMBER' or role == 'LAWYER')}">

  <!-- 버튼: role 담아두기 -->
  <button class="icon"
          id="chatIconBtn"
          type="button"
          aria-expanded="false"
          th:data-role="${role == 'MEMBER' ? 'MEMBER' : 'LAWYER'}"
          th:if="${role == 'MEMBER'}"
          aria-label="채팅 목록 열기">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true">
      <path d="M20 16c0 1.1-.9 2-2 2H9l-5 4V6c0-1.1.9-2 2-2h12c1.1 0 2 .9 2 2v10z"
            fill="none" stroke="currentColor" stroke-width="1.8" stroke-linejoin="round"></path>
      <path d="M8 8.5h8M8 11h8M8 13.5h6"
            fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"></path>
    </svg>
    <span class="badge" id="chatBadge" hidden>0</span>
  </button>
  <button class="icon"
          id="chatIconBtn"
          type="button"
          aria-expanded="false"
          th:data-role="LAWYER"
          th:if="${role == 'LAWYER'}"
          aria-label="상담 메인으로 이동">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true">
      <path d="M20 16c0 1.1-.9 2-2 2H9l-5 4V6c0-1.1.9-2 2-2h12c1.1 0 2 .9 2 2v10z"
            fill="none" stroke="currentColor" stroke-width="1.8" stroke-linejoin="round"></path>
      <path d="M8 8.5h8M8 11h8M8 13.5h6"
            fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"></path>
    </svg>
    <span class="badge" id="chatBadge" hidden>0</span>
  </button>

  <!-- 숨겨진 값들: JS에서 사용 -->
  <input type="hidden" id="memberIdx"
         th:if="${user != null and role != null and role == 'MEMBER'}"
         th:value="${user.memberIdx}">
  <input type="hidden" id="lawyerIdx"
         th:if="${user != null and role != null and role == 'LAWYER'}"
         th:value="${user.lawyerIdx}">

  <!-- 회원일 때만 나오는 패널 -->
  <section class="panel"
           id="chatPanel"
           th:if="${user != null and role != null and role == 'MEMBER'}"
           hidden>
    <div class="tabs" role="tablist">
      <div class="tab is-active" data-filter="all" aria-selected="true">
        전체 <span class="cnt-all">0</span>
      </div>
      <div class="tab" data-filter="live" aria-selected="false">
        상담중 <span class="cnt-live">0</span>
      </div>
      <div class="tab" data-filter="wait" aria-selected="false">
        대기중 <span class="cnt-wait">0</span>
      </div>
      <div class="tab" data-filter="end" aria-selected="false">
        종료 <span class="cnt-end">0</span>
      </div>
      <span class="sp total-label">총 0건</span>
    </div>
    <div class="list" id="chatList" role="list">
      <p class="empty">채팅방이 없습니다.</p>
    </div>
  </section>
</div>
